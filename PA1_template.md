# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

1. The file is first read as a csv file using the read.csv() command.
2. The overview of the data is obtained used head, summary and str commands.
3. Data is then transformed by converting steps to numeric. Interval is split into hours and minutes and also converted to a fator for later use.


```r
# Run this file from thr RepData_PeerAssessment1 directory
# Load the File
ActivityData <- read.csv("activity.csv")

# Quick Exploration of Data
head(ActivityData, 10)
```

```
##    steps       date interval
## 1     NA 2012-10-01        0
## 2     NA 2012-10-01        5
## 3     NA 2012-10-01       10
## 4     NA 2012-10-01       15
## 5     NA 2012-10-01       20
## 6     NA 2012-10-01       25
## 7     NA 2012-10-01       30
## 8     NA 2012-10-01       35
## 9     NA 2012-10-01       40
## 10    NA 2012-10-01       45
```

```r
str(ActivityData)
```

```
## 'data.frame':	17568 obs. of  3 variables:
##  $ steps   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : Factor w/ 61 levels "2012-10-01","2012-10-02",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ interval: int  0 5 10 15 20 25 30 35 40 45 ...
```

```r
summary(ActivityData)
```

```
##      steps                date          interval     
##  Min.   :  0.00   2012-10-01:  288   Min.   :   0.0  
##  1st Qu.:  0.00   2012-10-02:  288   1st Qu.: 588.8  
##  Median :  0.00   2012-10-03:  288   Median :1177.5  
##  Mean   : 37.38   2012-10-04:  288   Mean   :1177.5  
##  3rd Qu.: 12.00   2012-10-05:  288   3rd Qu.:1766.2  
##  Max.   :806.00   2012-10-06:  288   Max.   :2355.0  
##  NA's   :2304     (Other)   :15840
```

```r
# Data Processing and Transformation
ActivityData$steps <- as.numeric(ActivityData$steps)
ActivityData$minutes <- ActivityData$interval %% 100
ActivityData$hour <- ActivityData$interval %/% 100
ActivityData$interval <- as.factor(ActivityData$interval)

str(ActivityData)
```

```
## 'data.frame':	17568 obs. of  5 variables:
##  $ steps   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : Factor w/ 61 levels "2012-10-01","2012-10-02",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ interval: Factor w/ 288 levels "0","5","10","15",..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ minutes : num  0 5 10 15 20 25 30 35 40 45 ...
##  $ hour    : num  0 0 0 0 0 0 0 0 0 0 ...
```

```r
summary(ActivityData)
```

```
##      steps                date          interval        minutes     
##  Min.   :  0.00   2012-10-01:  288   0      :   61   Min.   : 0.00  
##  1st Qu.:  0.00   2012-10-02:  288   5      :   61   1st Qu.:13.75  
##  Median :  0.00   2012-10-03:  288   10     :   61   Median :27.50  
##  Mean   : 37.38   2012-10-04:  288   15     :   61   Mean   :27.50  
##  3rd Qu.: 12.00   2012-10-05:  288   20     :   61   3rd Qu.:41.25  
##  Max.   :806.00   2012-10-06:  288   25     :   61   Max.   :55.00  
##  NA's   :2304     (Other)   :15840   (Other):17202                  
##       hour      
##  Min.   : 0.00  
##  1st Qu.: 5.75  
##  Median :11.50  
##  Mean   :11.50  
##  3rd Qu.:17.25  
##  Max.   :23.00  
## 
```


## What is mean total number of steps taken per day?

1. Using the *reshape2* package, the processed data is melted first. Using dcast based on date, then the total number of steps per day is calculated.
2. The total number of steps per day calculated from the previous step is used to draw the histogram ('Histogram1.png' is available).
3. Using the total number of steps per day calculated from the first step for each of the 61 days, the mean and median total number of steps taken per day is calculated.


```r
# Total Number of Steps per day
library(reshape2)
```

```
## Warning: package 'reshape2' was built under R version 3.1.2
```

```r
MeltedActivityData <- melt(ActivityData, id = c("date", "hour", "minutes", "interval"))
StepsPerDay <- dcast(MeltedActivityData, date ~ variable, fun.aggregate = sum)
StepsPerDay
```

```
##          date steps
## 1  2012-10-01    NA
## 2  2012-10-02   126
## 3  2012-10-03 11352
## 4  2012-10-04 12116
## 5  2012-10-05 13294
## 6  2012-10-06 15420
## 7  2012-10-07 11015
## 8  2012-10-08    NA
## 9  2012-10-09 12811
## 10 2012-10-10  9900
## 11 2012-10-11 10304
## 12 2012-10-12 17382
## 13 2012-10-13 12426
## 14 2012-10-14 15098
## 15 2012-10-15 10139
## 16 2012-10-16 15084
## 17 2012-10-17 13452
## 18 2012-10-18 10056
## 19 2012-10-19 11829
## 20 2012-10-20 10395
## 21 2012-10-21  8821
## 22 2012-10-22 13460
## 23 2012-10-23  8918
## 24 2012-10-24  8355
## 25 2012-10-25  2492
## 26 2012-10-26  6778
## 27 2012-10-27 10119
## 28 2012-10-28 11458
## 29 2012-10-29  5018
## 30 2012-10-30  9819
## 31 2012-10-31 15414
## 32 2012-11-01    NA
## 33 2012-11-02 10600
## 34 2012-11-03 10571
## 35 2012-11-04    NA
## 36 2012-11-05 10439
## 37 2012-11-06  8334
## 38 2012-11-07 12883
## 39 2012-11-08  3219
## 40 2012-11-09    NA
## 41 2012-11-10    NA
## 42 2012-11-11 12608
## 43 2012-11-12 10765
## 44 2012-11-13  7336
## 45 2012-11-14    NA
## 46 2012-11-15    41
## 47 2012-11-16  5441
## 48 2012-11-17 14339
## 49 2012-11-18 15110
## 50 2012-11-19  8841
## 51 2012-11-20  4472
## 52 2012-11-21 12787
## 53 2012-11-22 20427
## 54 2012-11-23 21194
## 55 2012-11-24 14478
## 56 2012-11-25 11834
## 57 2012-11-26 11162
## 58 2012-11-27 13646
## 59 2012-11-28 10183
## 60 2012-11-29  7047
## 61 2012-11-30    NA
```

```r
# Histogram for Number of Steps per day
png(file = "Histogram1.png")
hist(StepsPerDay$steps, main = "Histogram for Steps/Day", xlab = "Steps/Day", ylab = "# of Days",
     border = "black", col = "blue")
dev.off()
```

```
## quartz_off_screen 
##                 2
```

```r
# Mean and Median Number of Steps per day
mean(StepsPerDay$steps, na.rm = TRUE)
```

```
## [1] 10766.19
```

```r
median(StepsPerDay$steps, na.rm = TRUE)
```

```
## [1] 10765
```

## What is the average daily activity pattern?

1. To calculate the average steps per interval, the dcast command based on interval is used.
2. The Time Series is then plotted based on the dcast output, with interval along the X-axis and the average number of steps along the Y-axis ('TimeSeries1.png' is available).
3. Using the which.max command the interval with the maximum number of average steps is obtained. The answer was interval number 104, which is between 8:35 am and 8:40 am.


```r
# Average Number of Steps per interval
StepsPerInterval <- dcast(MeltedActivityData, interval ~ variable, fun.aggregate = mean, na.rm = TRUE)
StepsPerInterval$interval <- as.numeric(StepsPerInterval$interval)
StepsPerInterval
```

```
##     interval       steps
## 1          1   1.7169811
## 2          2   0.3396226
## 3          3   0.1320755
## 4          4   0.1509434
## 5          5   0.0754717
## 6          6   2.0943396
## 7          7   0.5283019
## 8          8   0.8679245
## 9          9   0.0000000
## 10        10   1.4716981
## 11        11   0.3018868
## 12        12   0.1320755
## 13        13   0.3207547
## 14        14   0.6792453
## 15        15   0.1509434
## 16        16   0.3396226
## 17        17   0.0000000
## 18        18   1.1132075
## 19        19   1.8301887
## 20        20   0.1698113
## 21        21   0.1698113
## 22        22   0.3773585
## 23        23   0.2641509
## 24        24   0.0000000
## 25        25   0.0000000
## 26        26   0.0000000
## 27        27   1.1320755
## 28        28   0.0000000
## 29        29   0.0000000
## 30        30   0.1320755
## 31        31   0.0000000
## 32        32   0.2264151
## 33        33   0.0000000
## 34        34   0.0000000
## 35        35   1.5471698
## 36        36   0.9433962
## 37        37   0.0000000
## 38        38   0.0000000
## 39        39   0.0000000
## 40        40   0.0000000
## 41        41   0.2075472
## 42        42   0.6226415
## 43        43   1.6226415
## 44        44   0.5849057
## 45        45   0.4905660
## 46        46   0.0754717
## 47        47   0.0000000
## 48        48   0.0000000
## 49        49   1.1886792
## 50        50   0.9433962
## 51        51   2.5660377
## 52        52   0.0000000
## 53        53   0.3396226
## 54        54   0.3584906
## 55        55   4.1132075
## 56        56   0.6603774
## 57        57   3.4905660
## 58        58   0.8301887
## 59        59   3.1132075
## 60        60   1.1132075
## 61        61   0.0000000
## 62        62   1.5660377
## 63        63   3.0000000
## 64        64   2.2452830
## 65        65   3.3207547
## 66        66   2.9622642
## 67        67   2.0943396
## 68        68   6.0566038
## 69        69  16.0188679
## 70        70  18.3396226
## 71        71  39.4528302
## 72        72  44.4905660
## 73        73  31.4905660
## 74        74  49.2641509
## 75        75  53.7735849
## 76        76  63.4528302
## 77        77  49.9622642
## 78        78  47.0754717
## 79        79  52.1509434
## 80        80  39.3396226
## 81        81  44.0188679
## 82        82  44.1698113
## 83        83  37.3584906
## 84        84  49.0377358
## 85        85  43.8113208
## 86        86  44.3773585
## 87        87  50.5094340
## 88        88  54.5094340
## 89        89  49.9245283
## 90        90  50.9811321
## 91        91  55.6792453
## 92        92  44.3207547
## 93        93  52.2641509
## 94        94  69.5471698
## 95        95  57.8490566
## 96        96  56.1509434
## 97        97  73.3773585
## 98        98  68.2075472
## 99        99 129.4339623
## 100      100 157.5283019
## 101      101 171.1509434
## 102      102 155.3962264
## 103      103 177.3018868
## 104      104 206.1698113
## 105      105 195.9245283
## 106      106 179.5660377
## 107      107 183.3962264
## 108      108 167.0188679
## 109      109 143.4528302
## 110      110 124.0377358
## 111      111 109.1132075
## 112      112 108.1132075
## 113      113 103.7169811
## 114      114  95.9622642
## 115      115  66.2075472
## 116      116  45.2264151
## 117      117  24.7924528
## 118      118  38.7547170
## 119      119  34.9811321
## 120      120  21.0566038
## 121      121  40.5660377
## 122      122  26.9811321
## 123      123  42.4150943
## 124      124  52.6603774
## 125      125  38.9245283
## 126      126  50.7924528
## 127      127  44.2830189
## 128      128  37.4150943
## 129      129  34.6981132
## 130      130  28.3396226
## 131      131  25.0943396
## 132      132  31.9433962
## 133      133  31.3584906
## 134      134  29.6792453
## 135      135  21.3207547
## 136      136  25.5471698
## 137      137  28.3773585
## 138      138  26.4716981
## 139      139  33.4339623
## 140      140  49.9811321
## 141      141  42.0377358
## 142      142  44.6037736
## 143      143  46.0377358
## 144      144  59.1886792
## 145      145  63.8679245
## 146      146  87.6981132
## 147      147  94.8490566
## 148      148  92.7735849
## 149      149  63.3962264
## 150      150  50.1698113
## 151      151  54.4716981
## 152      152  32.4150943
## 153      153  26.5283019
## 154      154  37.7358491
## 155      155  45.0566038
## 156      156  67.2830189
## 157      157  42.3396226
## 158      158  39.8867925
## 159      159  43.2641509
## 160      160  40.9811321
## 161      161  46.2452830
## 162      162  56.4339623
## 163      163  42.7547170
## 164      164  25.1320755
## 165      165  39.9622642
## 166      166  53.5471698
## 167      167  47.3207547
## 168      168  60.8113208
## 169      169  55.7547170
## 170      170  51.9622642
## 171      171  43.5849057
## 172      172  48.6981132
## 173      173  35.4716981
## 174      174  37.5471698
## 175      175  41.8490566
## 176      176  27.5094340
## 177      177  17.1132075
## 178      178  26.0754717
## 179      179  43.6226415
## 180      180  43.7735849
## 181      181  30.0188679
## 182      182  36.0754717
## 183      183  35.4905660
## 184      184  38.8490566
## 185      185  45.9622642
## 186      186  47.7547170
## 187      187  48.1320755
## 188      188  65.3207547
## 189      189  82.9056604
## 190      190  98.6603774
## 191      191 102.1132075
## 192      192  83.9622642
## 193      193  62.1320755
## 194      194  64.1320755
## 195      195  74.5471698
## 196      196  63.1698113
## 197      197  56.9056604
## 198      198  59.7735849
## 199      199  43.8679245
## 200      200  38.5660377
## 201      201  44.6603774
## 202      202  45.4528302
## 203      203  46.2075472
## 204      204  43.6792453
## 205      205  46.6226415
## 206      206  56.3018868
## 207      207  50.7169811
## 208      208  61.2264151
## 209      209  72.7169811
## 210      210  78.9433962
## 211      211  68.9433962
## 212      212  59.6603774
## 213      213  75.0943396
## 214      214  56.5094340
## 215      215  34.7735849
## 216      216  37.4528302
## 217      217  40.6792453
## 218      218  58.0188679
## 219      219  74.6981132
## 220      220  85.3207547
## 221      221  59.2641509
## 222      222  67.7735849
## 223      223  77.6981132
## 224      224  74.2452830
## 225      225  85.3396226
## 226      226  99.4528302
## 227      227  86.5849057
## 228      228  85.6037736
## 229      229  84.8679245
## 230      230  77.8301887
## 231      231  58.0377358
## 232      232  53.3584906
## 233      233  36.3207547
## 234      234  20.7169811
## 235      235  27.3962264
## 236      236  40.0188679
## 237      237  30.2075472
## 238      238  25.5471698
## 239      239  45.6603774
## 240      240  33.5283019
## 241      241  19.6226415
## 242      242  19.0188679
## 243      243  19.3396226
## 244      244  33.3396226
## 245      245  26.8113208
## 246      246  21.1698113
## 247      247  27.3018868
## 248      248  21.3396226
## 249      249  19.5471698
## 250      250  21.3207547
## 251      251  32.3018868
## 252      252  20.1509434
## 253      253  15.9433962
## 254      254  17.2264151
## 255      255  23.4528302
## 256      256  19.2452830
## 257      257  12.4528302
## 258      258   8.0188679
## 259      259  14.6603774
## 260      260  16.3018868
## 261      261   8.6792453
## 262      262   7.7924528
## 263      263   8.1320755
## 264      264   2.6226415
## 265      265   1.4528302
## 266      266   3.6792453
## 267      267   4.8113208
## 268      268   8.5094340
## 269      269   7.0754717
## 270      270   8.6981132
## 271      271   9.7547170
## 272      272   2.2075472
## 273      273   0.3207547
## 274      274   0.1132075
## 275      275   1.6037736
## 276      276   4.6037736
## 277      277   3.3018868
## 278      278   2.8490566
## 279      279   0.0000000
## 280      280   0.8301887
## 281      281   0.9622642
## 282      282   1.5849057
## 283      283   2.6037736
## 284      284   4.6981132
## 285      285   3.3018868
## 286      286   0.6415094
## 287      287   0.2264151
## 288      288   1.0754717
```

```r
png(file = "TimeSeries1.png")
plot(StepsPerInterval$interval, StepsPerInterval$steps, type = "l", 
     xlab = "Interval", ylab = "Average Steps", main = "Steps/Interval")
dev.off()
```

```
## quartz_off_screen 
##                 2
```

```r
# Interval with Max Avg number of Steps
MaxInterval = which.max(StepsPerInterval$steps)
StepsPerInterval[MaxInterval,]
```

```
##     interval    steps
## 104      104 206.1698
```

## Imputing missing values
1. The number of NAs is obtained by summing on the is.na command. There were 2304 NAs.
2. The average for that interval calculated from the previous stage of the project was used to impute values into these NAs.
3. Again the newly imputed data is melted and dcasted to obtain the steps per interval for this imputed data set.
4. The revised histogram is then drawn based on the new data set. Similarly, the mean and median are calculated using the new data set.
5. The approach to impute the median value for NAs is a conservative approach. The addition of NAs resulted in adding more mass to the first bin of the histogram. It also brought down the mean on the Total Number of Steps per day. The median however did not change.


```r
# Number of missing values
sum(is.na(ActivityData$steps))
```

```
## [1] 2304
```

```r
# Imputing NAs with the median steps for that interval
ImputedActivityData <- ActivityData
ImputedActivityData[which(is.na(ImputedActivityData$steps)), 1] <- 
       StepsPerInterval[ImputedActivityData[which(is.na(ImputedActivityData$steps)), 3], 2]

# Total Number of Steps per day after Imputing for NAs
MeltedImputedData <- melt(ImputedActivityData, id = c("date", "hour", "minutes", "interval"))
StepsPerDayImputed <- dcast(MeltedImputedData, date ~ variable, fun.aggregate = sum)
StepsPerDayImputed
```

```
##          date    steps
## 1  2012-10-01 10766.19
## 2  2012-10-02   126.00
## 3  2012-10-03 11352.00
## 4  2012-10-04 12116.00
## 5  2012-10-05 13294.00
## 6  2012-10-06 15420.00
## 7  2012-10-07 11015.00
## 8  2012-10-08 10766.19
## 9  2012-10-09 12811.00
## 10 2012-10-10  9900.00
## 11 2012-10-11 10304.00
## 12 2012-10-12 17382.00
## 13 2012-10-13 12426.00
## 14 2012-10-14 15098.00
## 15 2012-10-15 10139.00
## 16 2012-10-16 15084.00
## 17 2012-10-17 13452.00
## 18 2012-10-18 10056.00
## 19 2012-10-19 11829.00
## 20 2012-10-20 10395.00
## 21 2012-10-21  8821.00
## 22 2012-10-22 13460.00
## 23 2012-10-23  8918.00
## 24 2012-10-24  8355.00
## 25 2012-10-25  2492.00
## 26 2012-10-26  6778.00
## 27 2012-10-27 10119.00
## 28 2012-10-28 11458.00
## 29 2012-10-29  5018.00
## 30 2012-10-30  9819.00
## 31 2012-10-31 15414.00
## 32 2012-11-01 10766.19
## 33 2012-11-02 10600.00
## 34 2012-11-03 10571.00
## 35 2012-11-04 10766.19
## 36 2012-11-05 10439.00
## 37 2012-11-06  8334.00
## 38 2012-11-07 12883.00
## 39 2012-11-08  3219.00
## 40 2012-11-09 10766.19
## 41 2012-11-10 10766.19
## 42 2012-11-11 12608.00
## 43 2012-11-12 10765.00
## 44 2012-11-13  7336.00
## 45 2012-11-14 10766.19
## 46 2012-11-15    41.00
## 47 2012-11-16  5441.00
## 48 2012-11-17 14339.00
## 49 2012-11-18 15110.00
## 50 2012-11-19  8841.00
## 51 2012-11-20  4472.00
## 52 2012-11-21 12787.00
## 53 2012-11-22 20427.00
## 54 2012-11-23 21194.00
## 55 2012-11-24 14478.00
## 56 2012-11-25 11834.00
## 57 2012-11-26 11162.00
## 58 2012-11-27 13646.00
## 59 2012-11-28 10183.00
## 60 2012-11-29  7047.00
## 61 2012-11-30 10766.19
```

```r
# Histogram for Number of Steps per day after Imputing for NAs
png(file = "Histogram2.png")
hist(StepsPerDayImputed$steps, main = "Histogram for Steps/Day (NAs Imputed)", xlab = "Steps/Day", ylab = "# of Days",
     border = "black", col = "red")
dev.off()
```

```
## quartz_off_screen 
##                 2
```

```r
# Mean and Median Number of Steps per day after Imputing for NAs
mean(StepsPerDayImputed$steps, na.rm = TRUE)
```

```
## [1] 10766.19
```

```r
median(StepsPerDayImputed$steps, na.rm = TRUE)
```

```
## [1] 10766.19
```


## Are there differences in activity patterns between weekdays and weekends?

1. Using a combination of weekdays() function and teh subsetting logic, two new data sets are created, one each for Weekdays and Weekends.
2. Using the two new data sets, melting and dcasting are done on these data sets.
3. Using the par command, the time series for the two data sets are drawn one below the other to compare the patterns during weekdays and during weekends.
4. It can be observed that during the weekdays, the number of steps is low during the day time (i.e. the normal business hours).


```r
# Add a new variable for Weekday and Weekend
ImputedActivityData[weekdays(as.Date(ImputedActivityData$date)) %in% c("Saturday", "Sunday"), 6] <- "Weekend"
ImputedActivityData[!weekdays(as.Date(ImputedActivityData$date)) %in% c("Saturday", "Sunday"), 6] <- "Weekday"
colnames(ImputedActivityData)[6] <- "day"

WeekdayActivityData <- ImputedActivityData[ImputedActivityData$day == "Weekday",]
WeekendActivityData <- ImputedActivityData[ImputedActivityData$day == "Weekend",]

MeltedWeekdayData <- melt(WeekdayActivityData, id = c("date", "hour", "minutes", "interval", "day"))
MeltedWeekendData <- melt(WeekendActivityData, id = c("date", "hour", "minutes", "interval", "day"))

WeekdayStepsPerInterval <- dcast(MeltedWeekdayData, interval ~ variable, fun.aggregate = mean, na.rm = TRUE)
WeekdayStepsPerInterval$interval <- as.numeric(WeekdayStepsPerInterval$interval)
WeekdayStepsPerInterval
```

```
##     interval        steps
## 1          1   2.25115304
## 2          2   0.44528302
## 3          3   0.17316562
## 4          4   0.19790356
## 5          5   0.09895178
## 6          6   1.59035639
## 7          7   0.69266247
## 8          8   1.13794549
## 9          9   0.00000000
## 10        10   1.79622642
## 11        11   0.39580713
## 12        12   0.01761006
## 13        13   0.42054507
## 14        14   0.09056604
## 15        15   0.19790356
## 16        16   0.44528302
## 17        17   0.00000000
## 18        18   1.45953878
## 19        19   2.22180294
## 20        20   0.02264151
## 21        21   0.22264151
## 22        22   0.25031447
## 23        23   0.34633124
## 24        24   0.00000000
## 25        25   0.00000000
## 26        26   0.00000000
## 27        27   1.39538784
## 28        28   0.00000000
## 29        29   0.00000000
## 30        30   0.17316562
## 31        31   0.00000000
## 32        32   0.29685535
## 33        33   0.00000000
## 34        34   0.00000000
## 35        35   2.02851153
## 36        36   1.23689727
## 37        37   0.00000000
## 38        38   0.00000000
## 39        39   0.00000000
## 40        40   0.00000000
## 41        41   0.02767296
## 42        42   0.81635220
## 43        43   1.23857442
## 44        44   0.52243187
## 45        45   0.42096436
## 46        46   0.09895178
## 47        47   0.00000000
## 48        48   0.00000000
## 49        49   0.26960168
## 50        50   1.23689727
## 51        51   2.23102725
## 52        52   0.00000000
## 53        53   0.44528302
## 54        54   0.04779874
## 55        55   3.37064990
## 56        56   0.22138365
## 57        57   3.77651992
## 58        58   0.88846960
## 59        59   2.34842767
## 60        60   0.72620545
## 61        61   0.00000000
## 62        62   2.05324948
## 63        63   3.93333333
## 64        64   2.18825996
## 65        65   4.22054507
## 66        66   2.70607966
## 67        67   2.74591195
## 68        68   7.94088050
## 69        69  20.40251572
## 70        70  23.64528302
## 71        71  50.34926625
## 72        72  56.26540881
## 73        73  41.28763103
## 74        74  64.59077568
## 75        75  70.08092243
## 76        76  77.14926625
## 77        77  63.92830189
## 78        78  60.03228512
## 79        79  66.44234801
## 80        80  47.97861635
## 81        81  55.66918239
## 82        82  54.86708595
## 83        83  47.04779874
## 84        84  60.42725367
## 85        85  50.59706499
## 86        86  50.82809224
## 87        87  62.02348008
## 88        88  69.33459119
## 89        89  63.10104822
## 90        90  59.10859539
## 91        91  66.22389937
## 92        92  54.35387841
## 93        93  62.72410901
## 94        94  83.38406709
## 95        95  67.73542977
## 96        96  66.57568134
## 97        97  82.71698113
## 98        98  71.96100629
## 99        99 144.01341719
## 100      100 181.98155136
## 101      101 200.57568134
## 102      102 183.60838574
## 103      103 198.88469602
## 104      104 230.37819706
## 105      105 218.90104822
## 106      106 185.65324948
## 107      107 191.23060797
## 108      108 177.09140461
## 109      109 167.66037736
## 110      110 125.78280922
## 111      111  93.94842767
## 112      112  87.30398323
## 113      113 103.54004193
## 114      114  92.46163522
## 115      115  58.51656184
## 116      116  35.85241090
## 117      117  27.46121593
## 118      118  40.85618449
## 119      119  39.13081761
## 120      120  17.62976939
## 121      121  37.87547170
## 122      122  18.21970650
## 123      123  39.07756813
## 124      124  47.82138365
## 125      125  30.34549266
## 126      126  35.15010482
## 127      127  33.12662474
## 128      128  24.25534591
## 129      129  23.51530398
## 130      130  25.91194969
## 131      131  22.03480084
## 132      132  23.25911950
## 133      133  21.69224319
## 134      134  25.09056604
## 135      135  11.68721174
## 136      136  16.27295597
## 137      137  24.18364780
## 138      138  23.72955975
## 139      139  32.76897275
## 140      140  50.19748428
## 141      141  44.56058700
## 142      142  47.92494759
## 143      143  50.11614256
## 144      144  56.13626834
## 145      145  55.71572327
## 146      146  72.84863732
## 147      147  83.64654088
## 148      148  75.28092243
## 149      149  48.71949686
## 150      150  46.82264151
## 151      151  62.57400419
## 152      152  30.74423480
## 153      153  21.98155136
## 154      154  29.32033543
## 155      155  32.78532495
## 156      156  56.59329140
## 157      157  24.60083857
## 158      158  25.74046122
## 159      159  24.56855346
## 160      160  15.64192872
## 161      161  35.63270440
## 162      162  44.85786164
## 163      163  31.76729560
## 164      164  23.30649895
## 165      165  25.23941300
## 166      166  40.18406709
## 167      167  25.57610063
## 168      168  36.33039832
## 169      169  46.92285115
## 170      170  39.55052411
## 171      171  32.12243187
## 172      172  45.04863732
## 173      173  27.48511530
## 174      174  30.76184486
## 175      175  31.49098532
## 176      176  14.51236897
## 177      177  11.54842767
## 178      178  21.98784067
## 179      179  41.86079665
## 180      180  38.28092243
## 181      181  30.86918239
## 182      182  35.05450734
## 183      183  29.95429769
## 184      184  31.91320755
## 185      185  39.86163522
## 186      186  37.34507338
## 187      187  42.12872117
## 188      188  50.93165618
## 189      189  90.56519916
## 190      190  95.86582809
## 191      191  93.94842767
## 192      192  70.30607966
## 193      193  46.88427673
## 194      194  45.19538784
## 195      195  56.60628931
## 196      196  36.13375262
## 197      197  26.80964361
## 198      198  29.52536688
## 199      199  22.51572327
## 200      200  21.83102725
## 201      201  25.86582809
## 202      202  31.99371069
## 203      203  27.62767296
## 204      204  32.42389937
## 205      205  23.57190776
## 206      206  44.95136268
## 207      207  34.18448637
## 208      208  48.07463312
## 209      209  60.11781971
## 210      210  72.37023061
## 211      211  56.14800839
## 212      212  65.82138365
## 213      213  82.87924528
## 214      214  59.33459119
## 215      215  34.50314465
## 216      216  37.59371069
## 217      217  26.64612159
## 218      218  46.62473795
## 219      219  67.22641509
## 220      220  82.64276730
## 221      221  61.39077568
## 222      222  73.45870021
## 223      223  79.22641509
## 224      224  81.49937107
## 225      225  91.71194969
## 226      226 115.46037736
## 227      227 101.30020964
## 228      228  90.59161426
## 229      229  87.56016771
## 230      230  77.22180294
## 231      231  62.38280922
## 232      232  54.38113208
## 233      233  37.88721174
## 234      234  20.56226415
## 235      235  29.09727463
## 236      236  45.98029350
## 237      237  30.04989518
## 238      238  18.58406709
## 239      239  44.26582809
## 240      240  27.29266247
## 241      241  13.39412998
## 242      242   5.55807128
## 243      243   6.82306080
## 244      244  14.11194969
## 245      245   8.70817610
## 246      246   5.71153040
## 247      247   9.77358491
## 248      248   7.15639413
## 249      249   8.96184486
## 250      250  13.10943396
## 251      251  25.97358491
## 252      252  17.30901468
## 253      253  11.37023061
## 254      254  18.89685535
## 255      255  28.50482180
## 256      256  18.94381551
## 257      257  14.28259958
## 258      258   8.04696017
## 259      259  12.79916143
## 260      260  16.50691824
## 261      261   7.13501048
## 262      262   7.59454927
## 263      263   8.26205451
## 264      264   3.43857442
## 265      265   1.52704403
## 266      266   4.42389937
## 267      267   6.30817610
## 268      268  11.15681342
## 269      269   9.27672956
## 270      270  10.84863732
## 271      271  12.78951782
## 272      272   2.89433962
## 273      273   0.04276730
## 274      274   0.14842767
## 275      275   1.90272537
## 276      276   2.01383648
## 277      277   3.55136268
## 278      278   3.73542977
## 279      279   0.00000000
## 280      280   1.08846960
## 281      281   1.26163522
## 282      282   1.87798742
## 283      283   3.03605870
## 284      284   2.24863732
## 285      285   2.24025157
## 286      286   0.26331237
## 287      287   0.29685535
## 288      288   1.41006289
```

```r
WeekendStepsPerInterval <- dcast(MeltedWeekendData, interval ~ variable, fun.aggregate = mean, na.rm = TRUE)
WeekendStepsPerInterval$interval <- as.numeric(WeekendStepsPerInterval$interval)
WeekendStepsPerInterval
```

```
##     interval        steps
## 1          1 2.146226e-01
## 2          2 4.245283e-02
## 3          3 1.650943e-02
## 4          4 1.886792e-02
## 5          5 9.433962e-03
## 6          6 3.511792e+00
## 7          7 6.603774e-02
## 8          8 1.084906e-01
## 9          9 0.000000e+00
## 10        10 5.589623e-01
## 11        11 3.773585e-02
## 12        12 4.540094e-01
## 13        13 4.009434e-02
## 14        14 2.334906e+00
## 15        15 1.886792e-02
## 16        16 4.245283e-02
## 17        17 0.000000e+00
## 18        18 1.391509e-01
## 19        19 7.287736e-01
## 20        20 5.837264e-01
## 21        21 2.122642e-02
## 22        22 7.346698e-01
## 23        23 3.301887e-02
## 24        24 0.000000e+00
## 25        25 0.000000e+00
## 26        26 0.000000e+00
## 27        27 3.915094e-01
## 28        28 0.000000e+00
## 29        29 0.000000e+00
## 30        30 1.650943e-02
## 31        31 0.000000e+00
## 32        32 2.830189e-02
## 33        33 0.000000e+00
## 34        34 0.000000e+00
## 35        35 1.933962e-01
## 36        36 1.179245e-01
## 37        37 0.000000e+00
## 38        38 0.000000e+00
## 39        39 0.000000e+00
## 40        40 0.000000e+00
## 41        41 7.134434e-01
## 42        42 7.783019e-02
## 43        43 2.702830e+00
## 44        44 7.606132e-01
## 45        45 6.863208e-01
## 46        46 9.433962e-03
## 47        47 0.000000e+00
## 48        48 0.000000e+00
## 49        49 3.773585e+00
## 50        50 1.179245e-01
## 51        51 3.508255e+00
## 52        52 0.000000e+00
## 53        53 4.245283e-02
## 54        54 1.232311e+00
## 55        55 6.201651e+00
## 56        56 1.895047e+00
## 57        57 2.686321e+00
## 58        58 6.662736e-01
## 59        59 5.264151e+00
## 60        60 2.201651e+00
## 61        61 0.000000e+00
## 62        62 1.957547e-01
## 63        63 3.750000e-01
## 64        64 2.405660e+00
## 65        65 7.900943e-01
## 66        66 3.682783e+00
## 67        67 2.617925e-01
## 68        68 7.570755e-01
## 69        69 3.689858e+00
## 70        70 3.417453e+00
## 71        71 8.806604e+00
## 72        72 1.137382e+01
## 73        73 3.936321e+00
## 74        74 6.158019e+00
## 75        75 7.909198e+00
## 76        76 2.493160e+01
## 77        77 1.068278e+01
## 78        78 1.063443e+01
## 79        79 1.195637e+01
## 80        80 1.504245e+01
## 81        81 1.125236e+01
## 82        82 1.408373e+01
## 83        83 1.010731e+01
## 84        84 1.700472e+01
## 85        85 2.472642e+01
## 86        86 2.623467e+01
## 87        87 1.812618e+01
## 88        88 1.281368e+01
## 89        89 1.286557e+01
## 90        90 2.812264e+01
## 91        91 2.602241e+01
## 92        92 1.610259e+01
## 93        93 2.284552e+01
## 94        94 3.063090e+01
## 95        95 3.004363e+01
## 96        96 2.683137e+01
## 97        97 4.710967e+01
## 98        98 5.765094e+01
## 99        99 8.842925e+01
## 100      100 8.875354e+01
## 101      101 8.839387e+01
## 102      102 7.604953e+01
## 103      103 1.166002e+02
## 104      104 1.380837e+02
## 105      105 1.313031e+02
## 106      106 1.624458e+02
## 107      107 1.613620e+02
## 108      108 1.386899e+02
## 109      109 7.536910e+01
## 110      110 1.191297e+02
## 111      111 1.517642e+02
## 112      112 1.666392e+02
## 113      113 1.042146e+02
## 114      114 1.058078e+02
## 115      115 8.783844e+01
## 116      116 7.159080e+01
## 117      117 1.728656e+01
## 118      118 3.284434e+01
## 119      119 2.331014e+01
## 120      120 3.069458e+01
## 121      121 4.813325e+01
## 122      122 5.162264e+01
## 123      123 5.180189e+01
## 124      124 6.627005e+01
## 125      125 6.305307e+01
## 126      126 9.478656e+01
## 127      127 7.566038e+01
## 128      128 7.442689e+01
## 129      129 6.614976e+01
## 130      130 3.516745e+01
## 131      131 3.369929e+01
## 132      132 5.636792e+01
## 133      133 5.854481e+01
## 134      134 4.258491e+01
## 135      135 4.841509e+01
## 136      136 5.163090e+01
## 137      137 4.017217e+01
## 138      138 3.418396e+01
## 139      139 3.530425e+01
## 140      140 4.937264e+01
## 141      141 3.494222e+01
## 142      142 3.526297e+01
## 143      143 3.456722e+01
## 144      144 6.777358e+01
## 145      145 8.679599e+01
## 146      146 1.294623e+02
## 147      147 1.263561e+02
## 148      148 1.419717e+02
## 149      149 1.046745e+02
## 150      150 5.958373e+01
## 151      151 3.168396e+01
## 152      152 3.711439e+01
## 153      153 3.931604e+01
## 154      154 6.140448e+01
## 155      155 7.956958e+01
## 156      156 9.734788e+01
## 157      157 9.222995e+01
## 158      158 7.967335e+01
## 159      159 9.584552e+01
## 160      160 1.122476e+02
## 161      161 7.609316e+01
## 162      162 8.899175e+01
## 163      163 7.365684e+01
## 164      164 3.026651e+01
## 165      165 8.137028e+01
## 166      166 9.113090e+01
## 167      167 1.084776e+02
## 168      168 1.296639e+02
## 169      169 8.059434e+01
## 170      170 8.687028e+01
## 171      171 7.582311e+01
## 172      172 5.896226e+01
## 173      173 5.793396e+01
## 174      174 5.663090e+01
## 175      175 7.098113e+01
## 176      176 6.406368e+01
## 177      177 3.276415e+01
## 178      178 3.757193e+01
## 179      179 4.857783e+01
## 180      180 5.922170e+01
## 181      181 2.762736e+01
## 182      182 3.894693e+01
## 183      183 5.106132e+01
## 184      184 5.835613e+01
## 185      185 6.312028e+01
## 186      186 7.703184e+01
## 187      187 6.501651e+01
## 188      188 1.057901e+02
## 189      189 6.136321e+01
## 190      190 1.065200e+02
## 191      191 1.250767e+02
## 192      192 1.223703e+02
## 193      193 1.050165e+02
## 194      194 1.173915e+02
## 195      195 1.250059e+02
## 196      196 1.392087e+02
## 197      197 1.415507e+02
## 198      198 1.448467e+02
## 199      199 1.039210e+02
## 200      200 8.563325e+01
## 201      201 9.752005e+01
## 202      202 8.330660e+01
## 203      203 9.846344e+01
## 204      204 7.533491e+01
## 205      205 1.114528e+02
## 206      206 8.822524e+01
## 207      207 9.721462e+01
## 208      208 9.821580e+01
## 209      209 1.081521e+02
## 210      210 9.743042e+01
## 211      211 1.049304e+02
## 212      212 4.233255e+01
## 213      213 5.319929e+01
## 214      214 4.856368e+01
## 215      215 3.553420e+01
## 216      216 3.705660e+01
## 217      217 8.014741e+01
## 218      218 9.006486e+01
## 219      219 9.571226e+01
## 220      220 9.285259e+01
## 221      221 5.328302e+01
## 222      222 5.178420e+01
## 223      223 7.339976e+01
## 224      224 5.384316e+01
## 225      225 6.741745e+01
## 226      226 5.443160e+01
## 227      227 4.519811e+01
## 228      228 7.157547e+01
## 229      229 7.729599e+01
## 230      230 7.954127e+01
## 231      231 4.581722e+01
## 232      232 5.048231e+01
## 233      233 3.191509e+01
## 234      234 2.115212e+01
## 235      235 2.261203e+01
## 236      236 2.325236e+01
## 237      237 3.065094e+01
## 238      238 4.513090e+01
## 239      239 4.958255e+01
## 240      240 5.106604e+01
## 241      241 3.714033e+01
## 242      242 5.687736e+01
## 243      243 5.454245e+01
## 244      244 8.741745e+01
## 245      245 7.772642e+01
## 246      246 6.464623e+01
## 247      247 7.660024e+01
## 248      248 6.122995e+01
## 249      249 4.931840e+01
## 250      250 4.441509e+01
## 251      251 5.010024e+01
## 252      252 2.814387e+01
## 253      253 2.880542e+01
## 254      254 1.252830e+01
## 255      255 9.244104e+00
## 256      256 2.009316e+01
## 257      257 7.306604e+00
## 258      258 7.939858e+00
## 259      259 1.989505e+01
## 260      260 1.572524e+01
## 261      261 1.302241e+01
## 262      262 8.349057e+00
## 263      263 7.766509e+00
## 264      264 3.278302e-01
## 265      265 1.244104e+00
## 266      266 1.584906e+00
## 267      267 6.014151e-01
## 268      268 1.063679e+00
## 269      269 8.844340e-01
## 270      270 2.649764e+00
## 271      271 1.219340e+00
## 272      272 2.759434e-01
## 273      273 1.102594e+00
## 274      274 1.415094e-02
## 275      275 7.629717e-01
## 276      276 1.188797e+01
## 277      277 2.600236e+00
## 278      278 3.561321e-01
## 279      279 0.000000e+00
## 280      280 1.037736e-01
## 281      281 1.202830e-01
## 282      282 7.606132e-01
## 283      283 1.387972e+00
## 284      284 1.158726e+01
## 285      285 6.287736e+00
## 286      286 1.705189e+00
## 287      287 2.830189e-02
## 288      288 1.344340e-01
```

```r
png(file = "TimeSeries2.png")
par(mfrow = c(2,1), mar=c(2,2,1,1), oma = c(0, 0, 0, 0))
plot(WeekdayStepsPerInterval$interval, WeekdayStepsPerInterval$steps, type = "l", 
     xlab = "Interval", ylab = "Average Steps", main = "Weekday", col = "blue", xaxt = "n")
plot(WeekendStepsPerInterval$interval, WeekendStepsPerInterval$steps, type = "l", 
     xlab = "Interval", ylab = "Average Steps", col = "red", main = "Weekend")
dev.off()
```

```
## quartz_off_screen 
##                 2
```
